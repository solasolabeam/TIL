# ğŸ† ì„±ì  ì…ì¶œë ¥ í”„ë¡œê·¸ë¨
#### DAO í´ë˜ìŠ¤
> DAO : 
Data Access Object
        ë°ì´í„°ë² ì´ìŠ¤ì˜ ë°ì´í„°ë¥¼ ì „ë¬¸ì ìœ¼ë¡œ í˜¸ì¶œí•˜ê³  ì œì–´í•˜ëŠ” ê°ì²´

```sql
package kr.s08.score;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

import kr.s03.preparedstatement.DBUtil;

public class ScoreDAO {
	// ì„±ì ì…ë ¥
	public void insertInfo(String name, int korean, int english, int math, int sum, int avg, String grade) {
		Connection conn = null;
		PreparedStatement pstmt = null;
		String sql = null;

		try {
			// JDBC ìˆ˜í–‰ 1,2ë‹¨ê³„
			conn = DBUtil.getConnection();

			// SQLë¬¸ ì‘ì„±
			sql = "INSERT INTO score (num,name,korean,english,math,"
					+ "sum,avg,grade,reg_date) VALUES (score_seq.nextval," + "?,?,?,?,?,?,?,SYSDATE)";

			// JDBC ìˆ˜í–‰ 3ë”˜ê³„
			pstmt = conn.prepareStatement(sql);

			// ?ì— ë°ì´í„° ë°”ì¸ë”©
			pstmt.setString(1, name);
			pstmt.setInt(2, korean);
			pstmt.setInt(3, english);
			pstmt.setInt(4, math);
			pstmt.setInt(5, sum);
			pstmt.setInt(6, avg);
			pstmt.setString(7, grade);

			// JDBC ìˆ˜í–‰ 4ë‹¨ê³„
			int count = pstmt.executeUpdate();
			System.out.println(count + "ê°œì˜ í–‰ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.");

		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			// ìì›ì •ë¦¬
			DBUtil.executeClose(null, pstmt, conn);
		}
	}

	// ëª©ë¡ë³´ê¸°
	public void selectInfo() {
		Connection conn = null;
		PreparedStatement pstmt = null;
		ResultSet rs = null;
		String sql = null;

		try {
			// JDBC ìˆ˜í–‰ 1,2ë‹¨ê³„
			conn = DBUtil.getConnection();

			// SQLë¬¸ ì‘ì„±
			sql = "SELECT * FROM score ORDER BY num DESC";
			// JDBC ìˆ˜í–‰ 3ë‹¨ê³„
			pstmt = conn.prepareStatement(sql);
			// JDBC ìˆ˜í–‰ 4ë‹¨ê³„
			rs = pstmt.executeQuery();

			System.out.println("---------------------------------------");
			System.out.println("ë²ˆí˜¸\tì´ë¦„\têµ­ì–´\tì˜ì–´\tìˆ˜í•™\tì´ì \tí‰ê· \të“±ê¸‰");
			while (rs.next()) {
				System.out.print(rs.getInt("num") + "\t");
				System.out.print(rs.getString("name") + "\t");
				System.out.print(rs.getInt("korean") + "\t");
				System.out.print(rs.getInt("english") + "\t");
				System.out.print(rs.getInt("math") + "\t");
				System.out.print(rs.getInt("sum") + "\t");
				System.out.print(rs.getInt("avg") + "\t");
				System.out.println(rs.getString("grade") + "\t");
			}
			System.out.println("---------------------------------------");

		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			DBUtil.executeClose(rs, pstmt, conn);
		}

	}

	// ì„±ì ìƒì„¸ë³´ê¸°
	public void selectDetailInfo(int num) {
		Connection conn = null;
		PreparedStatement pstmt = null;
		ResultSet rs = null;
		String sql = null;

		try {
			// JDBC ìˆ˜ì • 1,2 ë‹¨ê³„
			conn = DBUtil.getConnection();
			// SQLë¬¸ ì‘ì„±
			sql = "SELECT * FROM score WHERE num=?";

			// JDBC ìˆ˜í–‰ 3ë‹¨ê³„
			pstmt = conn.prepareStatement(sql);
			// ?ì— ë°ì´í„° ë°”ì¸ë”©
			pstmt.setInt(1, num);

			// JDBC ìˆ˜í–‰ 4ë‹¨ê³„
			rs = pstmt.executeQuery();
			// ì¶œë ¥ ë‚´ìš©(ë²ˆí˜¸,ì´ë¦„,êµ­ì–´,ì˜ì–´,ìˆ˜í•™,ì´ì ,í‰ê· ,ë“±ê¸‰,ë“±ë¡ì¼)
			if (rs.next()) {
				System.out.println("ë²ˆí˜¸ : " + rs.getInt("num"));
				System.out.println("ì´ë¦„ : " + rs.getString("name"));
				System.out.println("êµ­ì–´ : " + rs.getInt("korean"));
				System.out.println("ì˜ì–´ : " + rs.getInt("english"));
				System.out.println("ìˆ˜í•™ : " + rs.getInt("math"));
				System.out.println("ì´ì  : " + rs.getInt("sum"));
				System.out.println("í‰ê·  : " + rs.getInt("avg"));
				System.out.println("ë“±ê¸‰ : " + rs.getString("grade"));
				System.out.println("ë“±ë¡ì¼ : " + rs.getDate("reg_date"));
			} else {
				System.out.println("ê²€ìƒ‰ëœ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");
			}

		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			// ìì›ì •ë¦¬
			DBUtil.executeClose(rs, pstmt, conn);
		}
	}

	// ì„±ì ìˆ˜ì •
	public void updateInfo( int num, String name, int korean, int english, int math, int sum, int avg, String grade) {
		Connection conn = null;
		PreparedStatement pstmt = null;
		String sql = null;

		try {
			// JDBC ìˆ˜í–‰ 1,2ë‹¨ê³„
			conn = DBUtil.getConnection();

			// SQLë¬¸ ì‘ì„±
			sql = "UPDATE score SET name=?, korean=?, english=?, math=?, sum=?, avg=?, grade=? WHERE num=?";
			// JDBC ìˆ˜í–‰ 3ë‹¨ê³„
			pstmt = conn.prepareStatement(sql);
			// ?ì— ë°ì´í„° ë°”ì¸ë”©
			pstmt.setString(1, name);
			pstmt.setInt(2, korean);
			pstmt.setInt(3, english);
			pstmt.setInt(4, math);
			pstmt.setInt(5, sum);
			pstmt.setInt(6, avg);
			pstmt.setString(7, grade);
			pstmt.setInt(8, num);

			// JDBC ìˆ˜í–‰ 4ë‹¨ê³„
			int count = pstmt.executeUpdate();

			System.out.println(count + "ê°œì˜ í–‰ì„ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤.");

		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			// ìì›ì •ë¦¬
			DBUtil.executeClose(null, pstmt, conn);
		}
	}
	// ì„±ì ì‚­ì œ
	public void deleteInfo(int num) {
		Connection conn = null;
		PreparedStatement pstmt = null;
		String sql = null;
		
		try {
			//JDBC ìˆ˜í–‰ 1,2ë‹¨ê³„
			conn = DBUtil.getConnection();
			
			//SQLë¬¸ ì‘ì„±
			sql = "DELETE FROM score WHERE num=?";
			
			//JDBC ìˆ˜í–‰ 3ë‹¨ê³„
			pstmt = conn.prepareStatement(sql);
			//?ì— ë°ì´í„° ë°”ì¸ë”©
			pstmt.setInt(1, num);
			
			//JDBC ìˆ˜í–‰ 4ë‹¨ê³„
			int count = pstmt.executeUpdate();
			System.out.println(count + "ê°œì˜ í–‰ì„ ì‚­ì œí–ˆìŠµë‹ˆë‹¤.");
			
		}catch(Exception e) {
			e.printStackTrace();
		}finally {
			//ìì›ì •ë¦¬
			DBUtil.executeClose(null, pstmt, conn);
		}
	}

}
```
<br>

```sql
package kr.s08.score;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class ScoreMain {
	private BufferedReader br;
	private ScoreDAO dao;

	public ScoreMain() {
		dao = new ScoreDAO();
		try {
			br = new BufferedReader(new InputStreamReader(System.in));
			callMenu();
		} catch (IOException e) {
			e.printStackTrace();
		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			// ìì›ì •ë¦¬
			if (br != null)
				try {
					br.close();
				} catch (IOException e) {
				}
		}
	}

	// ë©”ë‰´
	public void callMenu() throws IOException {
		while (true) {
			System.out.print("1.ì…ë ¥,2.ëª©ë¡,3.ìƒì„¸ì •ë³´,4.ìˆ˜ì •,5.ì‚­ì œ," + "6.ì¢…ë£Œ>");
			try {
				int no = Integer.parseInt(br.readLine());
				if (no == 1) { // ì…ë ¥
					// ì´ë¦„ ì…ë ¥
					System.out.print("ì´ë¦„:");
					String name = br.readLine();
					// êµ­ì–´ ì…ë ¥
					int korean = parseInputData("êµ­ì–´: ");
					// ì˜ì–´ ì…ë ¥
					int english = parseInputData("ì˜ì–´: ");
					// ìˆ˜í•™ ì…ë ¥
					int math = parseInputData("ìˆ˜í•™: ");
					// ì´ì 
					int sum = makeSum(korean, english, math);
					// í‰ê· 
					int avg = makeAvg(sum);
					// ë“±ê¸‰
					String grade = makeGrade(avg);
					// í…Œì´ë¸”ì— ë°ì´í„° ì…ë ¥
					dao.insertInfo(name, korean, english, math, sum, avg, grade);

				} else if (no == 2) { // ëª©ë¡
					dao.selectInfo();

				} else if (no == 3) { // ìƒì„¸ì •ë³´
					System.out.print("ì„ íƒí•œ ê¸€ì˜ ë²ˆí˜¸:");
					int num = Integer.parseInt(br.readLine());
					dao.selectDetailInfo(num);
				} else if (no == 4) { // ìˆ˜ì •
					dao.selectInfo();

					System.out.print("ìˆ˜ì •í•  ê¸€ì˜ ë²ˆí˜¸:");
					int num = Integer.parseInt(br.readLine());

					// ì´ë¦„ ì…ë ¥
					System.out.print("ì´ë¦„:");
					String name = br.readLine();
					// êµ­ì–´ ì…ë ¥
					int korean = parseInputData("êµ­ì–´: ");
					// ì˜ì–´ ì…ë ¥
					int english = parseInputData("ì˜ì–´: ");
					// ìˆ˜í•™ ì…ë ¥
					int math = parseInputData("ìˆ˜í•™: ");
					// ì´ì 
					int sum = makeSum(korean, english, math);
					// í‰ê· 
					int avg = makeAvg(sum);
					// ë“±ê¸‰
					String grade = makeGrade(avg);

					dao.updateInfo(num, name, korean, english, math, sum, avg, grade);

				} else if (no == 5) { // ì‚­ì œ
					dao.selectInfo();

					System.out.print("ì‚­ì œí•  ê¸€ì˜ ë²ˆí˜¸:");
					int del_num = Integer.parseInt(br.readLine());

					dao.deleteInfo(del_num);

				} else if (no == 6) { // ì¢…ë£Œ
					System.out.println("í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.");
					break;
				} else {

				}

			} catch (NumberFormatException e) {
				System.out.println("ìˆ˜ìë§Œ ì…ë ¥ ê°€ëŠ¥");
			}
		}

	}

	// ì´ì êµ¬í•˜ê¸°
	public int makeSum(int korean, int english, int math) {
		return korean + english + math;
	}

	// í‰ê· êµ¬í•˜ê¸°
	public int makeAvg(int sum) {
		return sum / 3;
	}

	// ë“±ê¸‰êµ¬í•˜ê¸°
	public String makeGrade(int avg) {
		String grade;
		switch (avg / 10) {
		case 10:
		case 9:
			grade = "A";
			break;
		case 8:
			grade = "B";
			break;
		case 7:
			grade = "C";
			break;
		case 6:
			grade = "D";
			break;
		default:
			grade = "F";
		}
		return grade;
	}

	// ì„±ì  ë²”ìœ„ ì²´í¬ (0~100)
	public int parseInputData(String course) throws IOException {
		while (true) {
			System.out.println(course);
			try {
				int num = Integer.parseInt(br.readLine());

				if (num < 0 || num > 100) {
					throw new ScoreValueException("0~100ì‚¬ì´ì˜ ê°’ë§Œ ì¸ì •!");
				}
				return num;

			} catch (NumberFormatException e) {
				System.out.println("ìˆ«ìë§Œ ì…ë ¥í•˜ì‹œìš”!");
			} catch (ScoreValueException e) {
				System.out.println(e.getMessage());
			}
		}
	}

	public static void main(String[] args) {
		new ScoreMain();
	}
}
```
<br>

```
1.ì…ë ¥,2.ëª©ë¡,3.ìƒì„¸ì •ë³´,4.ìˆ˜ì •,5.ì‚­ì œ,6.ì¢…ë£Œ>2
---------------------------------------
ë²ˆí˜¸	ì´ë¦„	êµ­ì–´	ì˜ì–´	ìˆ˜í•™	ì´ì 	í‰ê· 	ë“±ê¸‰
3	ì™„ë²½	100	100	100	300	100	A	
2	í™ê¸¸ë™	88	99	77	264	88	B	
1	ê°€ë‚˜ë‹¤	90	80	90	260	86	B	
---------------------------------------
1.ì…ë ¥,2.ëª©ë¡,3.ìƒì„¸ì •ë³´,4.ìˆ˜ì •,5.ì‚­ì œ,6.ì¢…ë£Œ>3
ì„ íƒí•œ ê¸€ì˜ ë²ˆí˜¸:2
ë²ˆí˜¸ : 2
ì´ë¦„ : í™ê¸¸ë™
êµ­ì–´ : 88
ì˜ì–´ : 99
ìˆ˜í•™ : 77
ì´ì  : 264
í‰ê·  : 88
ë“±ê¸‰ : B
ë“±ë¡ì¼ : 2022-05-25
1.ì…ë ¥,2.ëª©ë¡,3.ìƒì„¸ì •ë³´,4.ìˆ˜ì •,5.ì‚­ì œ,6.ì¢…ë£Œ>
```